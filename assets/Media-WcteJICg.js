var y=(d,g,l)=>new Promise((r,u)=>{var c=o=>{try{v(l.next(o))}catch(f){u(f)}},p=o=>{try{v(l.throw(o))}catch(f){u(f)}},v=o=>o.done?r(o.value):Promise.resolve(o.value).then(c,p);v((l=l.apply(d,g)).next())});import{r as V,_}from"./index-YMKHBwjb.js";/* empty css                 *//* empty css                        */import{D as I,d as h,l as E}from"./element-plus-Cbe27J2b.js";import{v as N,r as s,c as U,x as P,y as z,B as w,M as n,u as i,K as x,a3 as b,H as F}from"./vue-chunks-COp0tDkU.js";const M=d=>y(void 0,null,function*(){return V.post({url:"/video",data:d})}),$=d=>y(void 0,null,function*(){return V.get({url:"/video/"+d.taskId})}),A={style:{margin:"2rem",display:"flex","justify-content":"right","align-items":"right"}},L={style:{"text-align":"center",margin:"auto 1rem"}},R={style:{position:"relative",float:"left",width:"50%","padding-right":"1rem"}},q={style:{position:"relative",float:"left",width:"50%"}},H=N({__name:"Media",setup(d){const g=s("https://v.douyin.com/i5jR61CW/"),l=s(!1),r=s(!1),u=s(!1),c=s("https://static.tongliaowang.com/files/tlfiles/images/1708/14/20170814010341915355.jpg"),p=s(""),v=s("");s("https://api.yyy001.com/api/videoparse");const o=U(()=>p.value==""),f=U(()=>c.value=="https://static.tongliaowang.com/files/tlfiles/images/1708/14/20170814010341915355.jpg"?"":c.value),D=()=>y(this,null,function*(){l.value=!0;let t=yield M({videoUrl:g.value});if(t.code==200){t.data.taskId;let e=setInterval(function(){return y(this,null,function*(){""+t.data.taskId;let a=yield $({taskId:t.data.taskId});a.code==200&&(a.data,clearInterval(e),l.value=!1)})},1e3)}});function K(){}function j(){let t=new Date().getTime()+".mp4";T(p.value,t)}function B(t){const e={method:"get",url:"http://localhost:7074/api/parse?path="+encodeURIComponent(t)};axios(e).then(a=>{l.value=!1;let k=a.data||null;if(r.value=!1,a.status==200){let m=k.first_frame;openDirectry(C(m))}},a=>{r.value=!1})}function C(t){const a=t.replace(/\\/g,"/").split("/");return a[a.length-1],a.slice(0,-1).join("/")}function T(t,e,a=!1){a?r.value=!0:u.value=!0,ipc.send("download-file",{url:t,fileName:e}),ipc.on("download-success",(k,m)=>{a?B(m):(u.value=!1,openDirectry(C(m)))}),ipc.on("download-error",(k,m)=>{console.error("视频下载失败:",m,t),r.value=!1,u.value=!1})}return(t,e)=>(P(),z(F,null,[w("div",null,[n(i(I),{type:"textarea",value:g.value,"onUpdate:value":e[0]||(e[0]=a=>g.value=a),placeholder:"请输入视频链接",rows:4},null,8,["value"])]),w("div",A,[n(i(h),{type:"primary",loading:l.value,onClick:e[1]||(e[1]=a=>D())},{default:x(()=>e[7]||(e[7]=[b(" 立即解析 ")])),_:1},8,["loading"]),n(i(h),{style:{"margin-left":"2rem"},type:"primary",loading:l.value,disabled:o.value,onClick:e[2]||(e[2]=a=>void 0)},{default:x(()=>e[8]||(e[8]=[b(" 下载视频 ")])),_:1},8,["loading","disabled"]),n(i(h),{style:{"margin-left":"2rem"},type:"primary",loading:r.value,disabled:o.value,onClick:e[3]||(e[3]=a=>j())},{default:x(()=>e[9]||(e[9]=[b(" 获取首尾帧 ")])),_:1},8,["loading","disabled"])]),w("div",L,[w("div",R,[n(i(E),{width:"100%",src:c.value},null,8,["src"])]),w("div",q,[n(i(I),{size:"large",value:v.value,"onUpdate:value":e[4]||(e[4]=a=>v.value=a),placeholder:"","addon-before":"视频标题："},null,8,["value"]),n(i(I),{size:"large",class:"input-margin-top",value:f.value,"onUpdate:value":e[5]||(e[5]=a=>f.value=a),placeholder:"","addon-before":"封面地址："},null,8,["value"]),n(i(I),{size:"large",class:"input-margin-top",value:p.value,"onUpdate:value":e[6]||(e[6]=a=>p.value=a),placeholder:"","addon-before":"视频地址："},null,8,["value"])])])],64))}}),Y=_(H,[["__scopeId","data-v-4ff7cd6f"]]);export{Y as default};
